<!DOCTYPE html>
<html lang="az">
<head>
    <meta charset="UTF-8">
    <title>⚙️ Admin - Kontent İdarəetməsi (Yerlər, Valyuta)</title>
    <style>
        /* Kontent kartları üçün sadə stil */
        .place-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px; }
        .place-card { border: 1px solid #333; padding: 10px; border-radius: 5px; background-color: #f4f4f4; }
        .form-section { border: 1px solid #ccc; padding: 15px; margin-bottom: 25px; border-radius: 8px; }
    </style>
</head>
<body>
    <h1>⚙️ Kontent İdarəetməsi</h1>

    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <ul class="flashes" style="list-style: none; padding: 0;">
            {% for category, message in messages %}
                <li style="border: 1px solid {% if category == 'error' %}red{% elif category == 'warning' %}orange{% else %}green{% endif %}; padding: 10px; margin-bottom: 10px;">
                    {{ message }}
                </li>
            {% endfor %}
            </ul>
        {% endif %}
    {% endwith %}

    <div style="margin-bottom: 20px;">
        <a href="{{ url_for('admin_panel') }}">🛠️ Ölkə İdarəetməsi</a> | 
        <a href="{{ url_for('category_panel') }}">📋 Kateqoriya İdarəetməsi</a> |
        <a href="{{ url_for('logout') }}">🚪 Çıxış</a>
    </div>

    <hr>

    <div class="form-section">
        <h2>1. Valyuta Məzənnəsi (AZN-ə Görə)</h2>
        <form method="POST" style="margin-bottom: 20px;">
            <input type="hidden" name="form_type" value="add_rate">
            <label for="code">Valyuta Kodu (Məs: USD):</label>
            <input type="text" id="code" name="code" maxlength="3" required style="width: 80px;">
            <label for="rate">Məzənnə (1 X = AZN):</label>
            <input type="number" id="rate" name="rate" step="0.0001" required style="width: 100px;">
            <button type="submit">Əlavə Et / Yenilə</button>
        </form>
        
        <h3>Mövcud Məzənnələr:</h3>
        <ul>
            <li>**AZN:** 1.0000 (Əsas Valyuta)</li>
            {% for rate in rates %}
                <li>**{{ rate.code }}:** {{ rate.azn_rate }} AZN</li>
            {% endfor %}
        </ul>
    </div>
    
    <hr>

    <div class="form-section">
        <h2>2. Turistik Kontent Əlavə Et</h2>
        <form method="POST">
            <input type="hidden" name="form_type" value="add_place">
            
            <label for="country_id">Ölkə:</label>
            <select name="country_id" required>
                {% for country in countries %}
                    <option value="{{ country.id }}">{{ country.name }} ({{ country.code }})</option>
                {% endfor %}
            </select>
            
            <label for="place_type">Növü (Tətbiqdəki Tab):</label>
            <select name="place_type" required>
                {% for type in place_types %}
                    <option value="{{ type }}">{{ type }}</option>
                {% endfor %}
            </select><br><br>

            <label for="name">Adı/Başlığı:</label>
            <input type="text" name="name" required style="width: 300px;"><br><br>

            <label for="description">Təsvir (Modal Məlumatı):</label>
            <textarea name="description" rows="3" style="width: 100%;"></textarea><br><br>

            <label for="rating">Reytinq (0-5):</label>
            <input type="number" name="rating" step="0.1" min="0" max="5" style="width: 60px;"> 
            
            <label for="price_range">Qiymət ($$-$$$):</label>
            <input type="text" name="price_range" style="width: 80px;">

            <label for="tags">Teqlər (vergüllə ayırın):</label>
            <input type="text" name="tags" style="width: 250px;"><br><br>

            <label for="location_url">Location URL (Maps Linki):</label>
            <input type="url" name="location_url" style="width: 400px;"><br><br>

            <label for="menu_image_url">Menu/Şəkil URL:</label>
            <input type="url" name="menu_image_url" style="width: 400px;"><br><br>

            <button type="submit">Kontent Əlavə Et</button>
        </form>
    </div>

    <hr>

    <h2>3. Mövcud Kontent</h2>
    <div class="place-grid">
        {% for place in places %}
        <div class="place-card">
            <strong>{{ place.name }}</strong> ({{ place.country.name }})
            <br>
            Növ: <em>{{ place.type }}</em> | Reytinq: {{ place.rating }} | Qiymət: {{ place.price_range if place.price_range else '-' }}
            <p style="font-size: 14px;">Təsvir: {{ place.description[:100] }}...</p>
            <form method="POST" style="display: inline-block;">
                <input type="hidden" name="form_type" value="delete_place">
                <input type="hidden" name="place_id" value="{{ place.id }}">
                <button type="submit" onclick="return confirm('Bu kontenti silməyə əminsinizmi?')" style="background-color: darkred; color: white; border: none; padding: 5px; cursor: pointer;">Sil</button>
            </form>
        </div>
        {% endfor %}
    </div>

</body>
</html>